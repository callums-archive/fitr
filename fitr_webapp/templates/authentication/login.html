{% extends  'base/layout.html'%}

{% block styles %}
<!-- <style>
    img {
        font-size: 1.125rem;
        text-anchor: middle;
    }

    ::-webkit-input-placeholder {
        text-align: center;
    }

    :-moz-placeholder { /* Firefox 18- */
        text-align: center;
    }

    ::-moz-placeholder {  /* Firefox 19+ */
        text-align: center;
    }

    :-ms-input-placeholder {
        text-align: center;
    }
</style> -->

<style>
  body {
    background: #F8F8F8;
    font-family: 'Muli', sans-serif;
  }

  .input-field input[type=date]:focus+label,
  .input-field input[type=text]:focus+label,
  .input-field input[type=email]:focus+label,
  .input-field input[type=password]:focus+label {
    color: #3f50b5;
  }

  .input-field input[type=date]:focus,
  .input-field input[type=text]:focus,
  .input-field input[type=email]:focus,
  .input-field input[type=password]:focus {
    border-bottom: 2px solid #3f50b5;
    box-shadow: none;
  }

  .input-field label {
    left: 0;
  }

  form {
    margin: 30px auto;
    align-items: center;
    justify-content: center;
    width: 45%;
  }

  .btn-large {
    height: 45px;
    line-height: 45px;
  }

  .m-b-none {
    margin-bottom: 0;
  }

  .padder-x {
    padding: 0 !important;
  }

  .m-md {
    margin-top: 10px;
    margin-bottom: 20px;
  }

  .forgotpassword {
    font-weight: bold;
  }

  h2 {
    margin-top: 50px;
    font-weight: 400 letter-spacing: 2px;
    padding: 20px;
  }

  @media(max-width: 700px) {
    form {
      width: 60%;
    }
  }

  @media(max-width: 530px) {
    form {
      width: 70%;
    }
  }

  @media(max-width: 450px) {
    form {
      width: 80%;
    }
  }
</style>
{% endblock styles %}

{% block content %}
<!-- <div class="d-flex justify-content-center" style="height: 100%;">
    <div class="d-flex align-items-center p-2" style="max-width: 400px">
        <form id="login">
            <div class="d-flex justify-content-center">
                <img class="mb-3" src="{{ url_for('static', filename='images/logo.png') }}" alt="" height="75">
            </div>

            <div class="form-group">
                <input type="text" class="form-control form-control-lg" name="identifier" placeholder="Username / Email" required>
            </div>

            <div class="form-group">
                <input type="password" class="form-control form-control-lg" name="password" placeholder="Password" required>
            </div>

            <button type="submit" class="mt-3 mb-3 btn btn-lg btn-primary btn-block">Sign in</button>

            <hr>

            <p class="mt-1 text-muted float-left">&copy; <script>document.write(new Date().getFullYear())</script></p>
            <a class="mt-1 float-right btn btn-sm btn-secondary" href="{{ url_for('UserRegistrationView:register_get') }}"><b><i class="fas fa-info-circle"></i> Need an account?</b></a>
        </form>
    </div>
</div> -->

<nav>
  <div class="nav-wrapper">
    <a href="{{ url_for('index') }}" class="left brand-logo">
      <img class="center-align" src="{{ url_for('static', filename='images/logo_white.png') }}" alt="">
    </a>
    <ul class="right">
      <li><a class="waves-effect waves-light btn">Button</a></li>
    </ul>
  </div>
</nav>

<div class="container">
  <div class="row m-b-none">
    <form method="post">
      <div class='input-field'>
        <input class='validate' type='email' name='email' id='email' />
        <label for='email'>Enter your email</label>
      </div>
      <div class='input-field col s12 padder-x'>
        <input class='validate' type='password' name='password' id='password' />
        <label for='password'>Enter your password</label>
      </div>
      <a href="main.html" class='col s12 btn waves-effect waves-light btn btn-large m-md indigo'>Login</a>
      <div>
        <label>
          <h6><a class="grey-text lighten-4 forgotpassword" href="main.html">Forgot Password?</a></h6>
        </label>
      </div>
    </form>
  </div>
</div>
{% endblock content %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function(e) {
    FormValidation.formValidation(
      document.getElementById('login'), {
        fields: {
          identifier: {
            validators: {
              notEmpty: {
                message: 'field is required'
              },
              stringLength: {
                min: 3,
                max: 30,
                message: 'Field must be between 3 and 30 characters'
              }
            }
          },
          password: {
            validators: {
              notEmpty: {
                message: 'field is required'
              }
            }
          },
        },
        plugins: {
          trigger: new FormValidation.plugins.Trigger(),
          bootstrap: new FormValidation.plugins.Bootstrap(),
          submitButton: new FormValidation.plugins.SubmitButton(),
        },
      }
    ).on('core.form.valid', function() {
      console.log($('#login').jsonString())
      console.log($('#login').jsonString())
      $.ajax({
        accept: 'application/json',
        contentType: 'application/json',
        type: "POST",
        url: "{{ url_for('UserAuthenticationView:login_post') }}",
        data: $('#login').jsonString()
      }).done(function(data, status, jqXHR) {
        window.location.replace(data.redirect);
      }).fail(function(data, status, jqXHR) {
        try {
          var error = data.responseJSON.error_msg;
        } catch (err) {
          var error = "Server Error, Try again.";
        }

        $.toast({
          text: error,
          heading: 'Error!',
          icon: 'error',
          showHideTransition: 'slide',
          allowToastClose: false,
          hideAfter: 3000,
          stack: 5,
          position: 'top-center',
          textAlign: 'left',
          loader: true,
          beforeShow: function() {},
          afterShown: function() {},
          beforeHide: function() {},
          afterHidden: function() {}
        });
      });
    });
  });
</script>
{% endblock scripts %}
